# RSSHub

CLI-Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ´Ğ»Ñ Ğ°Ğ³Ñ€ĞµĞ³Ğ°Ñ†Ğ¸Ğ¸ RSS-Ğ»ĞµĞ½Ñ‚ Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¼ Ñ„Ğ¾Ğ½Ğ¾Ğ²Ñ‹Ğ¼ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸ĞµĞ¼ Ğ¸ Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸ĞµĞ¼ Ğ² PostgreSQL. ĞŸÑ€Ğ¾ĞµĞºÑ‚ Ğ´ĞµĞ¼Ğ¾Ğ½ÑÑ‚Ñ€Ğ¸Ñ€ÑƒĞµÑ‚ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñƒ Ñ ĞºĞ¾Ğ½ĞºÑƒÑ€ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒÑ, Worker Pool Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ğ¾Ğ¼ Ğ¸ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸ĞµĞ¼ Ğ¶Ğ¸Ğ·Ğ½ĞµĞ½Ğ½Ñ‹Ğ¼ Ñ†Ğ¸ĞºĞ»Ğ¾Ğ¼ Ğ³Ğ¾Ñ€ÑƒÑ‚Ğ¸Ğ½.

## ğŸš€ Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸

- **ĞĞ³Ñ€ĞµĞ³Ğ°Ñ†Ğ¸Ñ RSS**: Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ ÑĞ±Ğ¾Ñ€ ÑÑ‚Ğ°Ñ‚ĞµĞ¹ Ğ¸Ğ· Ğ¼Ğ½Ğ¾Ğ¶ĞµÑÑ‚Ğ²Ğ° RSS-Ğ¸ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸ĞºĞ¾Ğ²
- **Worker Pool**: Ğ¿Ğ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ»ĞµĞ½Ñ‚ Ñ Ğ½Ğ°ÑÑ‚Ñ€Ğ°Ğ¸Ğ²Ğ°ĞµĞ¼Ñ‹Ğ¼ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾Ğ¼ Ğ²Ğ¾Ñ€ĞºĞµÑ€Ğ¾Ğ²
- **Ğ”Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ°Ñ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ**: Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ Ğ¸Ğ½Ñ‚ĞµÑ€Ğ²Ğ°Ğ»Ğ° Ğ¸ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ° Ğ²Ğ¾Ñ€ĞºĞµÑ€Ğ¾Ğ² Ğ±ĞµĞ· Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑĞºĞ°
- **PostgreSQL Ñ…Ñ€Ğ°Ğ½Ğ¸Ğ»Ğ¸Ñ‰Ğµ**: ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğµ Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ»ĞµĞ½Ñ‚ Ğ¸ ÑÑ‚Ğ°Ñ‚ĞµĞ¹
- **CLI Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ**: ÑƒĞ´Ğ¾Ğ±Ğ½Ğ¾Ğµ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ‡ĞµÑ€ĞµĞ· ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ Ñ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ğ»Ğ°
- **Docker Compose**: Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾Ğµ Ñ€Ğ°Ğ·Ğ²ĞµÑ€Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ²ÑĞµĞ¹ Ğ¸Ğ½Ñ„Ñ€Ğ°ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹
- **Graceful Shutdown**: ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾Ğµ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ğµ Ğ²ÑĞµÑ… Ğ³Ğ¾Ñ€ÑƒÑ‚Ğ¸Ğ½

## ğŸ› ï¸ Ğ¢ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ğ¸

- **Ğ¯Ğ·Ñ‹Ğº**: Go (Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ğ°Ñ Ğ±Ğ¸Ğ±Ğ»Ğ¸Ğ¾Ñ‚ĞµĞºĞ° + pgx/v5)
- **Ğ‘Ğ°Ğ·Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…**: PostgreSQL
- **ĞšĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ**: Docker Compose
- **ĞŸĞ°Ñ‚Ñ‚ĞµÑ€Ğ½Ñ‹**: Worker Pool, Ticker, Context cancellation
- **XML Parsing**: encoding/xml

## ğŸ“¦ Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ°

```bash
# ĞšĞ»Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¹
git clone https://github.com/ebairamo/rsshub.git
cd rsshub

# Ğ¡Ğ¾Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚
go build -o rsshub .
```

### Docker Compose

```bash
# Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ PostgreSQL
docker-compose up -d
```

## ğŸ¯ Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

### ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ

Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ Ñ„Ğ°Ğ¹Ğ» `.env`:

```env
# CLI App
CLI_APP_TIMER_INTERVAL=3m
CLI_APP_WORKERS_COUNT=3

# PostgreSQL
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=changeme
POSTGRES_DBNAME=rsshub
```

### ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹

#### Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ RSS Ğ»ĞµĞ½Ñ‚Ñƒ

```bash
./rsshub add --name "tech-crunch" --url "https://techcrunch.com/feed/"
```

#### Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ñ„Ğ¾Ğ½Ğ¾Ğ²ÑƒÑ Ğ°Ğ³Ñ€ĞµĞ³Ğ°Ñ†Ğ¸Ñ

```bash
# Ğ’ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ¼ Ñ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ğ»Ğµ
./rsshub fetch
# Ğ’Ñ‹Ğ²Ğ¾Ğ´: The background process for fetching feeds has started (interval = 3 minutes, workers = 3)
```

#### Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ¸Ğ½Ñ‚ĞµÑ€Ğ²Ğ°Ğ» Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ

```bash
# Ğ’Ğ¾ Ğ²Ñ‚Ğ¾Ñ€Ğ¾Ğ¼ Ñ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ğ»Ğµ (Ğ¿Ğ¾ĞºĞ° fetch Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚)
./rsshub set-interval 2m
# Ğ’Ñ‹Ğ²Ğ¾Ğ´: Interval of fetching feeds changed from 3 minutes to 2 minutes
```

#### Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ²Ğ¾Ñ€ĞºĞµÑ€Ğ¾Ğ²

```bash
./rsshub set-workers 5
# Ğ’Ñ‹Ğ²Ğ¾Ğ´: Number of workers changed from 3 to 5
```

#### ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ»ĞµĞ½Ñ‚

```bash
# ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ²ÑĞµ Ğ»ĞµĞ½Ñ‚Ñ‹
./rsshub list

# ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ 5 Ğ»ĞµĞ½Ñ‚
./rsshub list --num 5
```

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ°:**
```
# Available RSS Feeds

1. Name: tech-crunch
   URL: https://techcrunch.com/feed/
   Added: 2025-06-10 15:34

2. Name: hacker-news
   URL: https://news.ycombinator.com/rss
   Added: 2025-06-10 15:37

3. Name: bbc-world
   URL: http://feeds.bbci.co.uk/news/world/rss.xml
   Added: 2025-06-11 09:15
```

#### ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚ÑŒĞ¸ Ğ¸Ğ· Ğ»ĞµĞ½Ñ‚Ñ‹

```bash
# ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ 5 Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ñ… ÑÑ‚Ğ°Ñ‚ĞµĞ¹
./rsshub articles --feed-name "tech-crunch" --num 5

# ĞŸĞ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ 3 ÑÑ‚Ğ°Ñ‚ÑŒĞ¸
./rsshub articles --feed-name "hacker-news"
```

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ°:**
```
Feed: tech-crunch

1. [2025-06-18] Apple announces new M4 chips for MacBook Pro
   https://techcrunch.com/apple-announces-m4/

2. [2025-06-17] OpenAI launches GPT-5 with multimodal capabilities
   https://techcrunch.com/openai-launches-gpt-5/

3. [2025-06-16] Google unveils new privacy tools at I/O 2025
   https://techcrunch.com/google-privacy-io-2025/
```

#### Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ»ĞµĞ½Ñ‚Ñƒ

```bash
./rsshub delete --name "tech-crunch"
```

#### Ğ¡Ğ¿Ñ€Ğ°Ğ²ĞºĞ°

```bash
./rsshub --help
```

## ğŸ—ï¸ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

### Worker Pool Pattern

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Ticker    â”‚
                    â”‚  (3 min)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Fetcher   â”‚
                    â”‚  Get N feedsâ”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚    Jobs Channel         â”‚
              â”‚  (Feed URLs queue)      â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                â”‚                â”‚
          â–¼                â–¼                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Worker 1 â”‚     â”‚ Worker 2 â”‚    â”‚ Worker N â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                â”‚                â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ PostgreSQL  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹

**Ticker**
- ĞŸĞµÑ€Ğ¸Ğ¾Ğ´Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ñ‚Ğ°Ğ¹Ğ¼ĞµÑ€ (Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ 3 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹)
- Ğ”Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ÑĞµĞ¼Ñ‹Ğ¹ Ğ¸Ğ½Ñ‚ĞµÑ€Ğ²Ğ°Ğ»
- Graceful shutdown Ñ‡ĞµÑ€ĞµĞ· context

**Worker Pool**
- N Ğ³Ğ¾Ñ€ÑƒÑ‚Ğ¸Ğ½ Ğ´Ğ»Ñ Ğ¿Ğ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ğ¾Ğ¹ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸
- ĞœĞ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€ÑƒĞµĞ¼Ñ‹Ğ¹ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€ (Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ¸Ğ·Ğ¼ĞµĞ½ÑÑ‚ÑŒ Ğ½Ğ° Ğ»ĞµÑ‚Ñƒ)
- Ğ§Ñ‚ĞµĞ½Ğ¸Ğµ Ğ¸Ğ· Ğ¾Ğ±Ñ‰ĞµĞ³Ğ¾ ĞºĞ°Ğ½Ğ°Ğ»Ğ° jobs

**Fetcher**
- ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ N ÑĞ°Ğ¼Ñ‹Ñ… Ğ½ĞµĞ°ĞºÑ‚ÑƒĞ°Ğ»ÑŒĞ½Ñ‹Ñ… Ğ»ĞµĞ½Ñ‚ Ğ¸Ğ· Ğ‘Ğ”
- ĞŸĞ°Ñ€ÑĞ¸Ñ‚ RSS XML
- ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸ Ğ² jobs channel

## ğŸ’¾ Ğ‘Ğ°Ğ·Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

### Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° feeds

Ğ¥Ñ€Ğ°Ğ½Ğ¸Ñ‚ Ğ¼ĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¾ RSS Ğ»ĞµĞ½Ñ‚Ğ°Ñ….

```sql
CREATE TABLE feeds (
    id UUID PRIMARY KEY,
    created_at TIMESTAMP,
    updated_at TIMESTAMP,
    name TEXT UNIQUE,
    url TEXT
);
```

### Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° articles

Ğ¥Ñ€Ğ°Ğ½Ğ¸Ñ‚ Ğ²ÑĞµ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ğ½Ñ‹Ğµ ÑÑ‚Ğ°Ñ‚ÑŒĞ¸.

```sql
CREATE TABLE articles (
    id UUID PRIMARY KEY,
    created_at TIMESTAMP,
    updated_at TIMESTAMP,
    title TEXT,
    link TEXT,
    published_at TIMESTAMP,
    description TEXT,
    feed_id UUID REFERENCES feeds(id)
);
```

## ğŸ“ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° RSS

ĞŸÑ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ¿Ğ°Ñ€ÑĞ¸Ñ‚ RSS feeds ÑĞ»ĞµĞ´ÑƒÑÑ‰ĞµĞ¹ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹:

```xml
<rss version="2.0">
  <channel>
    <title>RSS Feed Example</title>
    <link>https://www.example.com</link>
    <description>This is an example RSS feed</description>
    <item>
      <title>First Article</title>
      <link>https://www.example.com/article1</link>
      <description>Article content...</description>
      <pubDate>Mon, 06 Sep 2021 12:00:00 GMT</pubDate>
    </item>
  </channel>
</rss>
```

## ğŸ”„ Workflow

### Ğ¢Ğ¸Ğ¿Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

**Ğ¢ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ğ» 1 - ĞĞ³Ñ€ĞµĞ³Ğ°Ñ‚Ğ¾Ñ€:**
```bash
$ ./rsshub fetch
The background process for fetching feeds has started (interval = 3 minutes, workers = 3)

# Ğ”Ğ»Ñ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸: Ctrl+C
Graceful shutdown: aggregator stopped
```

**Ğ¢ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ğ» 2 - Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ:**
```bash
# Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ»ĞµĞ½Ñ‚Ñ‹
$ ./rsshub add --name "tech-crunch" --url "https://techcrunch.com/feed/"
$ ./rsshub add --name "hacker-news" --url "https://news.ycombinator.com/rss"

# Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸
$ ./rsshub set-interval 2m
Interval of fetching feeds changed from 3 minutes to 2 minutes

$ ./rsshub set-workers 5
Number of workers changed from 3 to 5

# ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ²
$ ./rsshub list
$ ./rsshub articles --feed-name "tech-crunch" --num 5
```

## ğŸ”§ Ğ¢ĞµÑ…Ğ½Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ´ĞµÑ‚Ğ°Ğ»Ğ¸

### ĞšĞ¾Ğ½ĞºÑƒÑ€ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹ Ğ¸ Ñ€ĞµÑˆĞµĞ½Ğ¸Ñ:**

| ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ° | Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ |
|----------|---------|
| Data Race | `sync.Mutex` Ğ¸Ğ»Ğ¸ `atomic` Ğ´Ğ»Ñ Ğ¾Ğ±Ñ‰Ğ¸Ñ… Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ñ… |
| Goroutine Leaks | Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ `context.Context` Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ¼ĞµĞ½Ñ‹ |
| Ğ”ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ‚Ñ‹ Ticker | ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° ÑÑ‚Ğ°Ñ€Ğ¾Ğ³Ğ¾ ticker Ğ¿ĞµÑ€ĞµĞ´ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸ĞµĞ¼ Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ |
| Ğ—Ğ°ĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ ĞºĞ°Ğ½Ğ°Ğ»Ğ° Ğ´Ğ²Ğ°Ğ¶Ğ´Ñ‹ | ĞšĞ°Ğ½Ğ°Ğ» Ğ·Ğ°ĞºÑ€Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¾Ğ´Ğ½Ğ¾Ğ¹ Ğ³Ğ¾Ñ€ÑƒÑ‚Ğ¸Ğ½Ğ¾Ğ¹ |
| Deadlock | Ğ’Ğ¾Ñ€ĞºĞµÑ€Ñ‹ Ğ²ÑĞµĞ³Ğ´Ğ° Ñ‡Ğ¸Ñ‚Ğ°ÑÑ‚ Ğ¸Ğ· ĞºĞ°Ğ½Ğ°Ğ»Ğ° jobs |

### Graceful Shutdown

ĞŸÑ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞ°ĞµÑ‚ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñƒ:
1. ĞŸÑ€Ğ¸ Ğ½Ğ°Ğ¶Ğ°Ñ‚Ğ¸Ğ¸ Ctrl+C
2. ĞŸÑ€Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğ¸ ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ğ° SIGINT/SIGTERM
3. ĞÑ‚Ğ¼ĞµĞ½ÑĞµÑ‚ context Ğ´Ğ»Ñ Ğ²ÑĞµÑ… Ğ³Ğ¾Ñ€ÑƒÑ‚Ğ¸Ğ½
4. ĞĞ¶Ğ¸Ğ´Ğ°ĞµÑ‚ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ñ Ğ²ÑĞµÑ… Ğ²Ğ¾Ñ€ĞºĞµÑ€Ğ¾Ğ²
5. Ğ—Ğ°ĞºÑ€Ñ‹Ğ²Ğ°ĞµÑ‚ ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ğµ Ñ Ğ‘Ğ”

## ğŸ“š Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµĞ¼Ñ‹Ğµ RSS Ğ»ĞµĞ½Ñ‚Ñ‹

```bash
# Ğ¢ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ğ¸
./rsshub add --name "tech-crunch" --url "https://techcrunch.com/feed/"
./rsshub add --name "hacker-news" --url "https://news.ycombinator.com/rss"
./rsshub add --name "the-verge" --url "https://www.theverge.com/rss/index.xml"
./rsshub add --name "ars-technica" --url "http://feeds.arstechnica.com/arstechnica/index"

# ĞĞ¾Ğ²Ğ¾ÑÑ‚Ğ¸
./rsshub add --name "bbc-world" --url "https://feeds.bbci.co.uk/news/world/rss.xml"
./rsshub add --name "un-news" --url "https://news.un.org/feed/subscribe/ru/news/all/rss.xml"
```

## âš ï¸ Ğ’Ğ°Ğ¶Ğ½Ñ‹Ğµ Ğ¿Ñ€ĞµĞ´ÑƒĞ¿Ñ€ĞµĞ¶Ğ´ĞµĞ½Ğ¸Ñ

**ĞĞµ ÑĞ¾Ğ·Ğ´Ğ°Ğ²Ğ°Ğ¹Ñ‚Ğµ DoS Ğ°Ñ‚Ğ°ĞºÑƒ!**
- ĞĞµ Ğ´ĞµĞ»Ğ°Ğ¹Ñ‚Ğµ ÑĞ»Ğ¸ÑˆĞºĞ¾Ğ¼ Ğ¼Ğ½Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² ÑĞ»Ğ¸ÑˆĞºĞ¾Ğ¼ Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾
- Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ Ñ€Ğ°Ğ·ÑƒĞ¼Ğ½Ñ‹Ğ¹ Ğ¸Ğ½Ñ‚ĞµÑ€Ğ²Ğ°Ğ» (Ğ¼Ğ¸Ğ½Ğ¸Ğ¼ÑƒĞ¼ 1 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ğ°)
- Ğ’Ñ‹Ğ²Ğ¾Ğ´Ğ¸Ñ‚Ğµ Ğ»Ğ¾Ğ³Ğ¸ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°
- Ğ‘ÑƒĞ´ÑŒÑ‚Ğµ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ñ‹ Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñƒ (Ctrl+C)

## ğŸ“ Ğ¦ĞµĞ»Ğ¸ Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ñ

Ğ­Ñ‚Ğ¾Ñ‚ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚ Ğ´ĞµĞ¼Ğ¾Ğ½ÑÑ‚Ñ€Ğ¸Ñ€ÑƒĞµÑ‚:
- Ğ Ğ°Ğ±Ğ¾Ñ‚Ñƒ Ñ XML Ğ¸ RSS Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ°Ğ¼Ğ¸
- ĞšĞ¾Ğ½ĞºÑƒÑ€ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¸ ĞºĞ°Ğ½Ğ°Ğ»Ñ‹ Ğ² Go
- Worker Pool Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½
- Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¶Ğ¸Ğ·Ğ½ĞµĞ½Ğ½Ñ‹Ğ¼ Ñ†Ğ¸ĞºĞ»Ğ¾Ğ¼ Ğ³Ğ¾Ñ€ÑƒÑ‚Ğ¸Ğ½
- Ğ Ğ°Ğ±Ğ¾Ñ‚Ñƒ Ñ PostgreSQL
- Docker Compose Ğ´Ğ»Ñ Ñ€Ğ°Ğ·Ğ²ĞµÑ€Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ñ
- Context cancellation Ğ´Ğ»Ñ graceful shutdown
- Race condition prevention

## ğŸ™ ĞĞ²Ñ‚Ğ¾Ñ€ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ

**@trech**
- [Email](mailto:trech@example.com)
- [GitHub](https://github.com/trech)
- [LinkedIn](https://www.linkedin.com/in/trech/)

---

*ĞŸÑ€Ğ¾ĞµĞºÑ‚ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½ Ğ² Ñ€Ğ°Ğ¼ĞºĞ°Ñ… Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ñ Ğ² ALEM School*
*Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ¾Ğ²Ğ¾Ğ¹ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚ Ñ: @akairamb*

# RSSHub

CLI application for RSS feed aggregation with automatic background updates and PostgreSQL storage. This project demonstrates concurrency, Worker Pool pattern, and goroutine lifecycle management.

## ğŸš€ Features

- **RSS Aggregation**: automatic article collection from multiple RSS sources
- **Worker Pool**: parallel feed processing with configurable worker count
- **Dynamic Configuration**: change interval and worker count without restart
- **PostgreSQL Storage**: structured storage of feeds and articles
- **CLI Interface**: convenient terminal-based management
- **Docker Compose**: simple infrastructure deployment
- **Graceful Shutdown**: proper termination of all goroutines

## ğŸ› ï¸ Tech Stack

- **Language**: Go (standard library only + pgx/v5)
- **Database**: PostgreSQL
- **Containerization**: Docker Compose
- **Patterns**: Worker Pool, Ticker, Context cancellation
- **XML Parsing**: encoding/xml

## ğŸ“¦ Installation

```bash
# Clone repository
git clone https://github.com/ebairamo/rsshub.git
cd rsshub

# Build project
go build -o rsshub .
```

### Docker Compose

```bash
# Start PostgreSQL
docker-compose up -d
```

## ğŸ¯ Usage

### Environment Setup

Create `.env` file:

```env
# CLI App
CLI_APP_TIMER_INTERVAL=3m
CLI_APP_WORKERS_COUNT=3

# PostgreSQL
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=changeme
POSTGRES_DBNAME=rsshub
```

### Main Commands

#### Add RSS Feed

```bash
./rsshub add --name "tech-crunch" --url "https://techcrunch.com/feed/"
```

#### Start Background Aggregation

```bash
# In first terminal
./rsshub fetch
# Output: The background process for fetching feeds has started (interval = 3 minutes, workers = 3)
```

#### Change Update Interval

```bash
# In second terminal (while fetch is running)
./rsshub set-interval 2m
# Output: Interval of fetching feeds changed from 3 minutes to 2 minutes
```

#### Change Worker Count

```bash
./rsshub set-workers 5
# Output: Number of workers changed from 3 to 5
```

#### Show Feed List

```bash
# Show all feeds
./rsshub list

# Show last 5 feeds
./rsshub list --num 5
```

**Example output:**
```
# Available RSS Feeds

1. Name: tech-crunch
   URL: https://techcrunch.com/feed/
   Added: 2025-06-10 15:34

2. Name: hacker-news
   URL: https://news.ycombinator.com/rss
   Added: 2025-06-10 15:37

3. Name: bbc-world
   URL: http://feeds.bbci.co.uk/news/world/rss.xml
   Added: 2025-06-11 09:15
```

#### Show Feed Articles

```bash
# Show last 5 articles
./rsshub articles --feed-name "tech-crunch" --num 5

# Default shows 3 articles
./rsshub articles --feed-name "hacker-news"
```

**Example output:**
```
Feed: tech-crunch

1. [2025-06-18] Apple announces new M4 chips for MacBook Pro
   https://techcrunch.com/apple-announces-m4/

2. [2025-06-17] OpenAI launches GPT-5 with multimodal capabilities
   https://techcrunch.com/openai-launches-gpt-5/

3. [2025-06-16] Google unveils new privacy tools at I/O 2025
   https://techcrunch.com/google-privacy-io-2025/
```

#### Delete Feed

```bash
./rsshub delete --name "tech-crunch"
```

#### Help

```bash
./rsshub --help
```

## ğŸ—ï¸ Architecture

### Worker Pool Pattern

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Ticker    â”‚
                    â”‚  (3 min)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Fetcher   â”‚
                    â”‚  Get N feedsâ”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚    Jobs Channel         â”‚
              â”‚  (Feed URLs queue)      â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                â”‚                â”‚
          â–¼                â–¼                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Worker 1 â”‚     â”‚ Worker 2 â”‚    â”‚ Worker N â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                â”‚                â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ PostgreSQL  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Components

**Ticker**
- Periodic timer (default 3 minutes)
- Dynamically changeable interval
- Graceful shutdown via context

**Worker Pool**
- N goroutines for parallel processing
- Scalable size (changeable on-the-fly)
- Reading from shared jobs channel

**Fetcher**
- Gets N most outdated feeds from DB
- Parses RSS XML
- Sends tasks to jobs channel

## ğŸ’¾ Database

### feeds Table

Stores RSS feed metadata.

```sql
CREATE TABLE feeds (
    id UUID PRIMARY KEY,
    created_at TIMESTAMP,
    updated_at TIMESTAMP,
    name TEXT UNIQUE,
    url TEXT
);
```

### articles Table

Stores all fetched articles.

```sql
CREATE TABLE articles (
    id UUID PRIMARY KEY,
    created_at TIMESTAMP,
    updated_at TIMESTAMP,
    title TEXT,
    link TEXT,
    published_at TIMESTAMP,
    description TEXT,
    feed_id UUID REFERENCES feeds(id)
);
```

## ğŸ“ RSS Structure

The application parses RSS feeds with the following structure:

```xml
<rss version="2.0">
  <channel>
    <title>RSS Feed Example</title>
    <link>https://www.example.com</link>
    <description>This is an example RSS feed</description>
    <item>
      <title>First Article</title>
      <link>https://www.example.com/article1</link>
      <description>Article content...</description>
      <pubDate>Mon, 06 Sep 2021 12:00:00 GMT</pubDate>
    </item>
  </channel>
</rss>
```

## ğŸ”„ Workflow

### Typical Usage Scenario

**Terminal 1 - Aggregator:**
```bash
$ ./rsshub fetch
The background process for fetching feeds has started (interval = 3 minutes, workers = 3)

# To stop: Ctrl+C
Graceful shutdown: aggregator stopped
```

**Terminal 2 - Management:**
```bash
# Add feeds
$ ./rsshub add --name "tech-crunch" --url "https://techcrunch.com/feed/"
$ ./rsshub add --name "hacker-news" --url "https://news.ycombinator.com/rss"

# Change settings
$ ./rsshub set-interval 2m
Interval of fetching feeds changed from 3 minutes to 2 minutes

$ ./rsshub set-workers 5
Number of workers changed from 3 to 5

# View results
$ ./rsshub list
$ ./rsshub articles --feed-name "tech-crunch" --num 5
```

## ğŸ”§ Technical Details

### Concurrency

**Problems and Solutions:**

| Problem | Solution |
|---------|----------|
| Data Race | `sync.Mutex` or `atomic` for shared variables |
| Goroutine Leaks | Use `context.Context` for cancellation |
| Duplicate Tickers | Stop old ticker before creating new one |
| Closing Channel Twice | Channel closed by only one goroutine |
| Deadlock | Workers always read from jobs channel |

### Graceful Shutdown

Application properly terminates:
1. On Ctrl+C press
2. On SIGINT/SIGTERM signal
3. Cancels context for all goroutines
4. Waits for all workers to finish
5. Closes DB connection

## ğŸ“š Recommended RSS Feeds

```bash
# Technology
./rsshub add --name "tech-crunch" --url "https://techcrunch.com/feed/"
./rsshub add --name "hacker-news" --url "https://news.ycombinator.com/rss"
./rsshub add --name "the-verge" --url "https://www.theverge.com/rss/index.xml"
./rsshub add --name "ars-technica" --url "http://feeds.arstechnica.com/arstechnica/index"

# News
./rsshub add --name "bbc-world" --url "https://feeds.bbci.co.uk/news/world/rss.xml"
./rsshub add --name "un-news" --url "https://news.un.org/feed/subscribe/en/news/all/rss.xml"
```

## âš ï¸ Important Warnings

**Don't DoS the servers!**
- Don't make too many requests too quickly
- Use reasonable interval (minimum 1 minute)
- Log every request
- Be ready to quickly stop the program (Ctrl+C)

## ğŸ“ Learning Objectives

This project demonstrates:
- Working with XML and RSS formats
- Concurrency and channels in Go
- Worker Pool pattern
- Goroutine lifecycle management
- Working with PostgreSQL
- Docker Compose deployment
- Context cancellation for graceful shutdown
- Race condition prevention

## ğŸ™ Project Author

**@trech**
- [Email](mailto:trech@example.com)
- [GitHub](https://github.com/trech)
- [LinkedIn](https://www.linkedin.com/in/trech/)

---

*Project completed as part of ALEM School curriculum*
*Group project with: @akairamb*
